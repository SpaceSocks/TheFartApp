import{W as r}from"./index-74_xLakG.js";class u{constructor(e){this.audio=e}}class s extends r{constructor(){super()}async resume(e){const t=this.getAudioAsset(e.assetId).audio;if(t.paused)return t.play()}async pause(e){return this.getAudioAsset(e.assetId).audio.pause()}async setCurrentTime(e){const t=this.getAudioAsset(e.assetId).audio;t.currentTime=e.time}async getCurrentTime(e){return{currentTime:this.getAudioAsset(e.assetId).audio.currentTime}}async getDuration(e){const t=this.getAudioAsset(e.assetId).audio;if(Number.isNaN(t.duration))throw"no duration available";if(!Number.isFinite(t.duration))throw"duration not available => media resource is streaming";return{duration:t.duration}}async configure(e){throw`configure is not supported for web: ${JSON.stringify(e)}`}async isPreloaded(e){try{return{found:!!this.getAudioAsset(e.assetId)}}catch{return{found:!1}}}async preload(e){var t;if(s.AUDIO_ASSET_BY_ASSET_ID.has(e.assetId))throw"AssetId already exists. Unload first if like to change!";if(!(!((t=e.assetPath)===null||t===void 0)&&t.length))throw"no assetPath provided";if(!e.isUrl&&!new RegExp("^/?"+s.FILE_LOCATION).test(e.assetPath)){const i=e.assetPath.startsWith("/")?"":"/";e.assetPath=`${s.FILE_LOCATION}${i}${e.assetPath}`}const a=new Audio(e.assetPath);a.autoplay=!1,a.loop=!1,a.preload="auto",e.volume&&(a.volume=e.volume),s.AUDIO_ASSET_BY_ASSET_ID.set(e.assetId,new u(a))}onEnded(e){this.notifyListeners("complete",{assetId:e})}async play(e){const{assetId:t,time:a=0}=e,i=this.getAudioAsset(t).audio;return await this.stop(e),i.loop=!1,i.currentTime=a,i.addEventListener("ended",()=>this.onEnded(t),{once:!0}),i.play()}async loop(e){const t=this.getAudioAsset(e.assetId).audio;return await this.stop(e),t.loop=!0,t.play()}async stop(e){const t=this.getAudioAsset(e.assetId).audio;t.pause(),t.loop=!1,t.currentTime=0}async unload(e){await this.stop(e),s.AUDIO_ASSET_BY_ASSET_ID.delete(e.assetId)}async setVolume(e){if(typeof e?.volume!="number")throw"no volume provided";const t=this.getAudioAsset(e.assetId).audio;t.volume=e.volume}async setRate(e){if(typeof e?.rate!="number")throw"no rate provided";const t=this.getAudioAsset(e.assetId).audio;t.playbackRate=e.rate}async isPlaying(e){return{isPlaying:!this.getAudioAsset(e.assetId).audio.paused}}async clearCache(){}getAudioAsset(e){if(this.checkAssetId(e),!s.AUDIO_ASSET_BY_ASSET_ID.has(e))throw`no asset for assetId "${e}" available. Call preload first!`;return s.AUDIO_ASSET_BY_ASSET_ID.get(e)}checkAssetId(e){if(typeof e!="string")throw"assetId must be a string";if(!e?.length)throw"no assetId provided"}async getPluginVersion(){return{version:"web"}}async deinitPlugin(){for(const[e]of s.AUDIO_ASSET_BY_ASSET_ID)await this.unload({assetId:e})}}s.FILE_LOCATION="";s.AUDIO_ASSET_BY_ASSET_ID=new Map;const n=new s;export{n as NativeAudio,s as NativeAudioWeb};
